# Fail2ban integration for SSHVigil
# This jail reads IPs from SSHVigil's blocklist and bans them
# Installation: sudo cp fail2ban-sshvigil.conf /etc/fail2ban/jail.d/

[sshvigil-blocklist]
enabled = true
# Path to SSHVigil's generated blocklist (must match --export-blocklist)
logpath = /var/lib/sshvigil/blocklist.txt
# Backend must be polling since SSHVigil appends to file
backend = polling
# Ban immediately (SSHVigil already analyzed the threat)
maxretry = 1
findtime = 86400
bantime = 604800
# Action to take (block SSH port)
action = iptables-multiport[name=sshvigil-ssh, port="ssh", protocol=tcp]
         sendmail-whois[name=sshvigil-ssh, dest=root@localhost]
